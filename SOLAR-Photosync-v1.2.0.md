# ‚òÄÔ∏è SOLAR PhotoSync v1.2.0 ‚Äî Command Routing Edition

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã Telegram**

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ v1.2.0](#—á—Ç–æ-–Ω–æ–≤–æ–≥–æ-–≤-v120)
2. [–ö–æ–º–∞–Ω–¥—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π](#–∫–æ–º–∞–Ω–¥—ã-–∫–∞—Ç–µ–≥–æ—Ä–∏–π)
3. [–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å](#–∫–∞–∫-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å)
4. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-–¥–µ—Ç–∞–ª–∏)
5. [–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ](#–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
6. [Changelog](#changelog)

---

## üÜï –ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ v1.2.0

### üéØ Command Routing ‚Äî –†—É—á–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é **–æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π**, –∏ –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —Ñ–æ—Ç–æ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ —ç—Ç—É –ø–∞–ø–∫—É!

**–†–∞–Ω—å—à–µ:**
```
[–§–æ—Ç–æ] + –ø–æ–¥–ø–∏—Å—å "/sprinter"    ‚Üê –Ω—É–∂–Ω–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑
[–§–æ—Ç–æ] + –ø–æ–¥–ø–∏—Å—å "/sprinter"
[–§–æ—Ç–æ] + –ø–æ–¥–ø–∏—Å—å "/sprinter"
```

**–¢–µ–ø–µ—Ä—å:**
```
/sprinter                        ‚Üê –æ–¥–∏–Ω —Ä–∞–∑!
üìÅ Active category ‚Üí Sprinter

[–§–æ—Ç–æ]  ‚Üí Sprinter/
[–§–æ—Ç–æ]  ‚Üí Sprinter/
[–§–æ—Ç–æ]  ‚Üí Sprinter/
...–≤—Å–µ —Ñ–æ—Ç–æ –≤ Sprinter!
```

### ‚è± –ê–≤—Ç–æ-—Å–±—Ä–æ—Å —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç

–ï—Å–ª–∏ –≤—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è 10 –º–∏–Ω—É—Ç ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ `Other`.

### üîÑ –†—É—á–Ω–æ–π —Å–±—Ä–æ—Å

–ö–æ–º–∞–Ω–¥—ã `/cancel` –∏–ª–∏ `/reset` –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é.

---

## üìÅ –ö–æ–º–∞–Ω–¥—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π

| –ö–æ–º–∞–Ω–¥–∞ | –ü–∞–ø–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-------|----------|
| `/sprinter` | Sprinter/ | –§–æ—Ç–æ Sprinter |
| `/actros` | Actros/ | –§–æ—Ç–æ Actros |
| `/engine` | Engine/ | –î–≤–∏–≥–∞—Ç–µ–ª–∏ |
| `/vin` | VIN/ | VIN –∫–æ–¥—ã |
| `/docs` | Documents/ | –î–æ–∫—É–º–µ–Ω—Ç—ã |
| `/invoice` | Invoice/ | –°—á–µ—Ç–∞ |
| `/photos` | Photos/ | –û–±—â–∏–µ —Ñ–æ—Ç–æ |
| `/tires` | Tires/ | –®–∏–Ω—ã |
| `/ldz` | LDZ/ | LDZ –≤–∞–≥–æ–Ω—ã |
| `/legal` | Legal/ | –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ |
| `/other` | Other/ | –î—Ä—É–≥–æ–µ |

### –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

| –ö–æ–º–∞–Ω–¥–∞ | –î–µ–π—Å—Ç–≤–∏–µ |
|---------|----------|
| `/cancel` | –°–±—Ä–æ—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Üí Other |
| `/reset` | –°–±—Ä–æ—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Üí Other |

---

## üì± –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ú–Ω–æ–≥–æ —Ñ–æ—Ç–æ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

```
–í—ã:     /sprinter
–ë–æ—Ç:    üìÅ Active category ‚Üí Sprinter
        All following photos will be saved to Sprinter/

–í—ã:     [–§–æ—Ç–æ 1]
–ë–æ—Ç:    ‚òÄÔ∏è Saved ‚Üí Sprinter / 2025-11-30

–í—ã:     [–§–æ—Ç–æ 2]
–ë–æ—Ç:    ‚òÄÔ∏è Saved ‚Üí Sprinter / 2025-11-30

–í—ã:     [–§–æ—Ç–æ 3]
–ë–æ—Ç:    ‚òÄÔ∏è Saved ‚Üí Sprinter / 2025-11-30

–í—ã:     /cancel
–ë–æ—Ç:    üîÑ Category reset ‚Üí Other
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

```
–í—ã:     /engine
–ë–æ—Ç:    üìÅ Active category ‚Üí Engine

–í—ã:     [–§–æ—Ç–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è]
–ë–æ—Ç:    ‚òÄÔ∏è Saved ‚Üí Engine / 2025-11-30

–í—ã:     /tires
–ë–æ—Ç:    üìÅ Active category ‚Üí Tires

–í—ã:     [–§–æ—Ç–æ —à–∏–Ω]
–ë–æ—Ç:    ‚òÄÔ∏è Saved ‚Üí Tires / 2025-11-30
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ë–µ–∑ –∫–æ–º–∞–Ω–¥—ã (–∞–≤—Ç–æ–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è)

```
–í—ã:     [–§–æ—Ç–æ –±–µ–∑ –∫–æ–º–∞–Ω–¥—ã]
–ë–æ—Ç:    ‚òÄÔ∏è Saved ‚Üí Other / 2025-11-30
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞

```
–í—ã:     /unknown
–ë–æ—Ç:    ‚ùó Unknown category command.
        
        Available: /actros, /docs, /engine...
        
        Reset: /cancel, /reset
```

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
UserStateManager
‚îú‚îÄ‚îÄ _user_states: Dict[user_id, {category, last_activity}]
‚îú‚îÄ‚îÄ CATEGORY_COMMANDS: Dict[command, folder]
‚îú‚îÄ‚îÄ RESET_COMMANDS: Set[/cancel, /reset]
‚îî‚îÄ‚îÄ INACTIVITY_TIMEOUT: 600 —Å–µ–∫—É–Ω–¥
```

### –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

```
1. –ü–æ–ª—É—á–∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ
2. –≠—Ç–æ –∫–æ–º–∞–Ω–¥–∞? ‚Üí –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–º–∞–Ω–¥—É
3. –≠—Ç–æ –º–µ–¥–∏–∞? ‚Üí –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è? ‚Üí –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë
   - –ù–µ—Ç? ‚Üí –ê–≤—Ç–æ–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª
5. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–π–º–∞—É—Ç–∞

–ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è `last_activity`:
- –ï—Å–ª–∏ –ø—Ä–æ—à–ª–æ > 10 –º–∏–Ω—É—Ç ‚Üí –∞–≤—Ç–æ-—Å–±—Ä–æ—Å –Ω–∞ Other
- –ï—Å–ª–∏ < 10 –º–∏–Ω—É—Ç ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é

### –õ–æ–≥–∏

```
[INFO] Command received: /sprinter
[INFO] Set active category ‚Üí Sprinter (user: 123456)
[INFO] Received photo: file_0.jpg
[INFO] Saved ‚Üí Sprinter / 2025-11-30

[INFO] Category auto-reset ‚Üí Other (was: Sprinter, user: 123456)
```

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
cd /var/www/SolarPhotoSync

# –ü–æ–ª—É—á–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
git pull

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
sudo systemctl restart solarphotosync

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é
curl https://www.swapoil.de/api/photosync/health
```

–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "status": "ok",
  "version": "1.2.0",
  ...
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
tail -f /var/www/SolarPhotoSync/logs/photosync.log
```

---

## üìù Changelog

### v1.2.0 ‚Äî Command Routing Edition (2025-11-30)

**üéØ Command Routing**
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π: /sprinter, /actros, /engine, /vin, /docs, /invoice, /photos, /tires, /ldz, /legal, /other
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã —Å–±—Ä–æ—Å–∞: /cancel, /reset
- ‚úÖ Per-user state management
- ‚úÖ –ê–≤—Ç–æ-—Å–±—Ä–æ—Å —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**üì± UX Improvements**
- ‚úÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –∫–æ–º–∞–Ω–¥—ã
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∫–æ–º–∞–Ω–¥–∞—Ö
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**üìù Logging**
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ-—Å–±—Ä–æ—Å–∞
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π

---

### v1.1.0 ‚Äî Deploy Edition (2025-11-30)
- Production deployment structure
- Systemd service
- Nginx reverse proxy
- Secret token management

### v1.0.1 (2025-11-30)
- Auto-response format
- Health endpoint improvements
- Root path autocreate

### v1.0.0 (2025-11-29)
- Initial release

---

## üë• –ö–æ–º–∞–Ω–¥–∞

- **Dashka** ‚Äî Senior Architect, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è
- **Claude** ‚Äî Engineer, —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- **Leanid** ‚Äî Architect Supervisor, –ø—Ä–∏—ë–º–∫–∞

---

**‚òÄÔ∏è SOLAR PhotoSync v1.2.0 Command Routing Edition**

*One command. All photos. Perfect organization.*
